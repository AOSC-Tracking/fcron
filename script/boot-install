#!/bin/sh
# Install fcron under SysV system.
#

# $Id: boot-install,v 1.10 2000-09-18 08:24:33 thib Exp $

# take 2 arguments : the name of the BSD-like install program
#                    and the DESTSBIN directory

PATH="/sbin:/usr/sbin:/bin:/usr/bin:/usr/X11R6/bin"

startdir=$pwd
DEBUG=1

if test $# -ne 2; then
    echo "Too few/many arguments"
    exit 1
fi

$1 -c -m 755 -o root fcron-launcher $2

if test -f /etc/rc.d/rc.M; then
    # Slackware
    if ! cat /etc/rc.d/rc.local | grep "fcron-launcher"; then
	echo "fcron-launcher" >> /etc/rc.d/rc.local
    fi

fi 
if test -f /etc/rc; then
    # FreeBSD
    if ! cat /etc/rc.local | grep "fcron-launcher"; then
	echo "fcron-launcher" >> /etc/rc.local
    fi
fi
ROOTDIR=""
if test -d /etc/rc.d/init.d/; then
    ROOTDIR="/etc/rc.d"
elif test -d /etc/init.d/; then
    ROOTDIR="/etc"
fi
if test $ROOTDIR != ""; then
    if test $DEBUG -eq 1; then
      $1 -c -m 755 -o root sysVinit-launcher-debug $ROOTDIR/init.d/fcron
    else
      $1 -c -m 755 -o root sysVinit-launcher $ROOTDIR/init.d/fcron
    fi
    
    cd $ROOTDIR/rc2.d/ ; ln -f -s ../init.d/fcron S40fcron
    cd $ROOTDIR/rc3.d/ ; ln -f -s ../init.d/fcron S40fcron
    cd $ROOTDIR/rc4.d/ ; ln -f -s ../init.d/fcron S40fcron
    cd $ROOTDIR/rc5.d/ ; ln -f -s ../init.d/fcron S40fcron
    
    cd $ROOTDIR/rc0.d/ ; ln -f -s ../init.d/fcron  K60fcron
    cd $ROOTDIR/rc6.d/ ; ln -f -s ../init.d/fcron  K60fcron
    cd $startdir
fi
